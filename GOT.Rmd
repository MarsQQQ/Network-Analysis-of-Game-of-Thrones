---
title: "Network Analysis on Game of Thrones"
output: html_notebook
---

In this article, I will be exploring and doing network analysis of the families of major characters from Game of Thrones which is a very famous TV series.

If you are a big Game of thrones fan then you should know that surprisingly, __House Stark__ (specifically Ned and Sansa) and __House Lannister__ (especially Tyrion) are the most important family connections in Game of Thrones; they also connect many of the storylines and are central parts of the Series.


##What is a Network ?

A network in this context is a graph of interconnected nodes/vertices. Nodes can e.g. be people in a social network, genes in a co-expression network, etc. Nodes are connected via edges.


##What can network analysis tell us?


Network analysis can e.g. be used to explore relationships in social or professional networks. In such cases, we would typically ask questions like:

1)How many connections does each person have?

2)Who is the most connected (i.e."famous","Dominating","influential" or 
“important”) person?

3)Are there clusters of tightly connected people?

4)Are there a few key objects that connect clusters of people?
etc.

The answers can give us a lots of information and insights of lots of things and how people interact.


-----------------------



##Implementing It in R





Loading the Required Packages

```{r,warning=FALSE,message=FALSE}

require(tidyverse)
require(ggthemes)
require(igraph)
require(statnet)
```



Now loading the Game of Thrones Datasets

```{r}
#Loading the Datasets
battle<-read.csv("battles.csv")

#Deaths on characters Dataset
deaths<-read.csv("character-deaths.csv")

#pred dataset
pred<-read.csv("character-pred.csv")

```


###Data Preprocessing and Transformation


```{r}
pred[pred == ""] <- NA
#Converting Individual columns to Character data type
pred$name <- as.character(pred$name)
pred$house <- as.character(pred$house)
pred$mother <- as.character(pred$mother)
pred$father <- as.character(pred$father)
pred$spouse <- as.character(pred$spouse)


pred$house <- ifelse(is.na(pred$house) & grepl("Targaryen", pred$name), "House Targaryen", pred$house)
pred$house <- ifelse(is.na(pred$house) & grepl("Stark", pred$name), "House Stark", pred$house)

#gsub() to perform replacement and pattern matching
pred$name <- gsub("[[:punct:]]", "", pred$name)

```


####Creating a new Child_of Dataframe which will contain the Parents and the child's name.


```{r}
child_of <- data.frame(name = pred$name[grepl("son of | daughter of", pred$name)],
                     stringsAsFactors = FALSE)

child_of$child_of <- ifelse(grepl("daughter", child_of$name), paste(gsub("(.* daughter of )(.*)", "\\2", child_of$name), 
  gsub("(.* )(.*)( daughter of.*)", "\\2", child_of$name)), paste(gsub("(.* son of )(.*)", "\\2", child_of$name), 
  gsub("(.* )(.*)( son of.*)", "\\2", child_of$name)))

child_of[child_of$name == "Ulf son of Umar", "child_of"] <- "Umar"

```



Performing a Left Join between the Child_of and Pred Datasets for joining both the tables Together i.e Merging.

```{r}
#Joining the 2 tables by common "name" column
pred<-left_join(pred, child_of, by = "name")

```


