---
title: "Network Analysis of Game of Thrones "
output: html_notebook
---


###This Article will now consist of the plotting Directed Acyclic Graphs of relationships 

The previous article consisted of the Data Processing,data scraping and preparing the data to be used in making Network DAGs.

```{r,warning=FALSE,message=FALSE}
require(igraph)

```
```{r}
#making a new data frame consisting of all people in House Frey
characters_Frey <- characters %>%
  filter(name %in% c("Emmon Frey", "Cleos Frey", "Tywin Frey", "Willem Frey", "Lyonel Frey", "Tion Frey", "Walder Frey son of Emmon", "Amerei Frey", "Lancel Lannister", "Merrett Frey", "Walda Frey daughter of Merrett", "Walder Frey son of Merrett", "Marissa Frey", "Roslin Frey", "Olyvar Frey", "Willamen Frey", "Benfrey Frey", "Perwyn Frey"))

net_Frey <- net %>%
  filter(source %in% characters_Frey$name | target %in% characters_Frey$name)

#adding line types and arrows i.e edges
net_Frey$lty <- "solid"
net_Frey$arrow <- ifelse(net_Frey$type == "spouse", 3, 2)

net_Frey <- net_Frey[net_Frey$type != "father/mother", ]
net_Frey <- rbind(net_Frey,
                  c("Perra Royce", "Walder Frey", "spouse", "#E7298A", "solid", 3),
                  c("Amarei Crakehall", "Walder Frey", "spouse", "#E7298A", "solid", 3),
                  c("Bethany Rosby", "Walder Frey", "spouse", "#E7298A", "solid", 3))

characters_Frey <- characters %>%
  filter(name %in% net_Frey$source | name %in% net_Frey$target) %>%
  arrange(name)


#?graph_from_data_frame to search on this function
graph_Frey <- graph_from_data_frame(net_Frey, directed = TRUE, vertices = characters_Frey)


```

Now we will generate Directed Acyclic Graphs using igraph package

```{r,out.height=15,out.width=20}
#using pdf to generate pdf graphics
pdf("family_frey_tree.pdf", width = 29, height = 20)
#Plotting the DAG for Frey family
plot(graph_Frey,
     layout = layout_with_lgl,
     vertex.label = gsub(" ", "\n", V(graph_Frey)$name),
     vertex.shape = V(graph_Frey)$shape,
     vertex.color = V(graph_Frey)$color, 
     vertex.size = (V(graph_Frey)$popularity + 0.5) * 5, 
     vertex.frame.color = "gray", 
     vertex.label.color = "black", 
     vertex.label.cex = 0.8,
     edge.arrow.mode = E(graph_Frey)$arrow,
     edge.arrow.size = 0.5,
     edge.color = E(graph_Frey)$color,
     edge.lty = E(graph_Frey)$lty)

legend("topleft", legend = c(as.character(color_vertices$house), as.character(colors_edges$type)), pch = 19,
       col = c(color_vertices$color, colors_edges$color), pt.cex = 2, cex = 1, bty = "n", ncol = 1)
dev.off()

```

